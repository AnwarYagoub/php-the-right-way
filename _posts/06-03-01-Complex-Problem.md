---
title: مشكلة معقدة
isChild: true
anchor:  complex_problem
---

## مشكلة معقدة {#complex_problem_title}

إذا كنت قرأت عن حقن التوابع سابقاً عندها قد لفت إنتباهك مصطلح *"Inversion of Control"* إنعكاس التحكم أو
*"Dependency Inversion Principle"* مفهوم عكس تحكم التوابع.
هذه المشاكل المعقدة التي يقوم حقن التوابع بحلها.

### إنعكاس التحكم

إنعكاس التحكم للنظام بإبقاء التحكم التنظيمي بالكامل بمنئى عن العناصر أو الكائنات. في مصطلح حقن التوابع هذا يعني
فك الإرتباط مع التوابع وعكس التحكم بهذه التوابع في مكان آخر في النظام.

لعدة سنين ، إطر النظام في PHP تستخدم عكس التحكم ولكن يبقى السؤال، أي جزء من التحكم هو الذي تقوم بعكسه؟ وإلى أين؟
مثلا إطر العمل بنموذج MVC تقدم بشكل عام كائن أساسي أو متحكم أساسي يجب على المتحكمات الفرعية الأخرى ان تستمد منه لكي
تحصل على وصول للتوابع. هذا **هو** عكس التحكم، لكن عوضاً عن فك إرتباط التوابع هذه الطريقة تقوم بترحيلهم.

حقن التوابع يتيح لنا بسلاسة حل هذه المشكلة، فقط عن طريق حقن التوابع التي نريد عندما نحتاجها بدون الحاجة لأي كتابة صريحة
لأي تابع في المصدر على الإطلاق.

### مفهوم عكس التحكم

مفهوم عكس التحكم هو حرف "D" في مجموعة مفاهيم البرمجة الشيئية S.O.L.I.D  والذي يوضح أنه يجب *"الإعتماد على التجريد، لا على
التحجير أو الإنغلاق"*. ببساطة هذا يعني انه التوابع يجب ان تكون واجهات او مجردات عوضاً عن التطبيقات الجامدة او المحجرة. عندها
يمكننا ببساطة إعادة صياغة وكتابة المفهوم أعلاه:

{% highlight php %}
<?php
namespace Database;

class Database
{
    protected $adapter;

    public function __construct(AdapterInterface $adapter)
    {
        $this->adapter = $adapter;
    }
}

interface AdapterInterface {}

class MysqlAdapter implements AdapterInterface {}
{% endhighlight %}

هنالك عدة فوائد يستفيد منها كلاس `Database` الآن، فهوالآن يعتمد على واجهة بدلاً من كائن جامد.

ضع بالإعتبار أنك تعمل ضمن فريق وأن المحول يقوم بالعمل عليه أحد الزملاء. في المثال الأول يجب أن نقوم بإنتظار زميلنا حتى
يخبرنا بأنه قد إنتهى من المحول حتى يتثنى لنا ان نعتمد عليه في إختبار الوحدة. الآن التابع هو عبارة عن واجهة يمكننا ان
نعتمد عليها بإعتبار ان زميلنا يسقوم ببناء المحول وفق الواجهة المحددة.

فائدة أكبر وهي ان هذه الطريقة تجعل المصدر قابل للتطوير. فمثلا بعد سنة قررنا أن نقوم بالترحيل إلى نوع آخر لقاعدة البيانات
يمكن أن نقوم بكاتبة محول يتبع شروط الواجهة الأصلية ثم يحقن عوضاً. عندها لا يوجد تعديل أو إعادة صياغة ويمكن أن نجزم بأن ذلك
المحول الجديد يتبع الشروط الموضوعة من قبل الواجهة.
